require "vnd.dovecot.testsuite";

require "enotify";

test "Invalid header name" {
	if valid_notify_method 
		"mailto:stephan@rename-it.nl?header:=frop" {
		test_fail "invalid uri accepted";
	}
}

test "Invalid recipient" {
	if valid_notify_method 
		"mailto:stephan%23rename-it.nl" {
		test_fail "invalid uri accepted";
	}
}

test "Invalid to header recipient" {
	if valid_notify_method
		"mailto:stephan@rename-it.nl?to=nico%23vestingbar.nl" {
		test_fail "invalid uri accepted";
	}
}

test "Valid URI" {
	if not valid_notify_method
		"mailto:stephan@rename-it.nl" {
		test_fail "valid uri denied";
	}
}
