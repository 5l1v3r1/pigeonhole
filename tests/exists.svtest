require "vnd.dovecot.testsuite";

test_set "message" text:
From: stephan@example.org
To: nico@vestingbar.bl
Subject: Test message
X-Spam-Status: Not Spam
Resent-To: nico@frop.example.com

Test!
.
;

test "EXISTS-one" {
	if not exists "from" {
		test_fail "exists test missed from header";
	}

	if exists "x-nonsense" {
        test_fail "exists test found non-existent header";
    }
}

test "EXISTS-two" {
    if not exists ["from","to"] {
        test_fail "exists test missed from or to header";
    }

    if exists ["from","to","x-nonsense"] {
        test_fail "exists test found non-existent header";
    }
}

test "EXISTS-three" {
    if not exists ["Subject","X-spam-STATUS","resent-to"] {
        test_fail "exists test missed from or to header";
    }

    if exists ["x-spam", "sub", "resent"] {
        test_fail "exists test found non-existent header";
    }
}
