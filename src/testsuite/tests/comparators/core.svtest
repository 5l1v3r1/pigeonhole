require "vnd.dovecot.testsuite";

test_set "message" text:
From: stephan@rename-it.nl
Cc: frop@example.com
To: test@dovecot.org
X-A: This is a TEST header
Subject: Test Message

Test!
.
;

# Comparator Tests

test "CMP-octet-CONTAINS" {
	if not header :contains :comparator "i;octet" "X-A" "TEST" {
		test_fail "should have matched";
	}
}

test "CMP-octet-NOTCONTAINS" {
	if header :contains :comparator "i;octet" "X-A" "test" {
		test_fail "should not have matched";
	}
}

test "CMP-octet-MATCH" {
	if not header :matches :comparator "i;octet" "X-A" "This*TEST*r" {
		test_fail "should have matched";
	}
}

test "CMP-octet-NOTMATCH" {
	if header :matches :comparator "i;octet" "X-A" "ThIs*tEsT*R" {
		test_fail "should not have matched";
	}
}

test "CMP-ascii-casemap-CONTAINS-1" {
	if not header :contains :comparator "i;ascii-casemap" "X-A" "TEST" {
		test_fail "should have matched";
	}
}

test "CMP-ascii-casemap-CONTAINS-2" {
	if not header :contains :comparator "i;ascii-casemap" "X-A" "test" {
		test_fail "should have matched";
	}
}

test "CMP-ascii-casemap-MATCH-1" {
	if not header :matches :comparator "i;ascii-casemap" "X-A" "This*TEST*r" {
		test_fail "should have matched";
	}
}

test "CMP-ascii-casemap-MATCH-2" {
	if not header :matches :comparator "i;ascii-casemap" "X-A" "ThIs*tEsT*R" {
		test_fail "should have matched";
	}
}



