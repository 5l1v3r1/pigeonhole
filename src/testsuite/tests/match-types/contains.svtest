require "vnd.dovecot.testsuite";

test_set "message" text:
From: stephan@rename-it.nl
Cc: frop@example.com
To: test@dovecot.org
X-Bullshit: f fr fro frop frob frobn frobnitzn
Subject: Test Message

Test!
.
;

# Match tests

test "MATCH-full" {
	if not address :contains "from" "stephan@rename-it.nl" {
		test_fail "should have matched";
	}
}

test "MATCH-begin" {
	if not address :contains "from" "stephan" {
		test_fail "should have matched";
	}
}

test "MATCH-end" {
	if not address :contains "from" "rename-it.nl" {
		test_fail "should have matched";
	}
}

test "MATCH-middle" {
	if not address :contains "from" "@" {
		test_fail "should have matched";
	}
}

test "MATCH-similar-beginnings" {
	if not header :contains "x-bullshit" "frobnitzn" {
		test_fail "should have matched";
	}
}

test "MATCH-empty" {
	if not header :contains "x-bullshit" "" {
		test_fail "contains tests fails to match \"\"";
	}
}

# Non-match tests

test "NO-MATCH-full-typo" {
	if address :contains "to" "frob@example.com" {
		test_fail "should not have matched";
	}
}

test "NO-MATCH-end-typo" {
	if header :contains "x-bullshit" "frobnitzm" {
		test_fail "should not have matched";
	}
}


